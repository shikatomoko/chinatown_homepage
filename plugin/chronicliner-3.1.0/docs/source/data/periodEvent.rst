==================================
期間イベント設定
==================================

Excelファイルの ``イベント`` シートを使用し、各イベントの設定を行います。

1. 概要
===============================

.. csv-table::
    :header: "カラム名", "設定", "使用可能な値", "概要", "設定例"

    ":ref:`categoryEP`", "必須", "``all`` 、 ``{カテゴリ名}`` 、 ``{キャラクタ名}``", "イベントの対象範囲を設定する", "all"
    ":ref:`titleP`", "必須", "文字列（セル内改行可）", "イベントのタイトルを設定する", "第2次魔法戦争開戦"
    ":ref:`startDate`", "必須", "``yyyy/MM/dd hh:mm`` 形式の日時、 ``yyyy/MM/dd`` 形式の日付", "イベントの開始日時を設定する", "1990/1/1 15:00"
    ":ref:`endDate`", "必須", "``yyyy/MM/dd hh:mm`` 形式の日時、 ``yyyy/MM/dd`` 形式の日付", "イベントの終了日時を設定する", "1991/1/1 15:00"
    ":ref:`limitP`", "任意", "``month`` 、 ``day`` 、 ``hour`` 、 ``minute`` 、 ``second``", "指定した値より細かい時間設定をイベントカード上で無効化する", "minute"
    ":ref:`display`", "任意", "``year`` 、 ``month`` 、 ``day`` 、 ``hour`` 、 ``minute`` 、 ``second``", "タイムライン列ホバー時に表示するイベント開始からの経過時間の表示粒度を指定する", "minute"
    ":ref:`startDetail`", "任意", "文字列（セル内改行可）", "期間イベント開始イベントの詳細を設定する", "場所：ホグワーツ"
    ":ref:`endDetail`", "任意", "文字列（セル内改行可）", "期間イベント終了イベントの詳細を設定する", "場所：ホグワーツ"
    ":ref:`impEVP`", "任意", "``TRUE`` 、 ``FALSE``", "重要イベントハイライトモードでハイライトするかを設定する", "TRUE"
    ":ref:`tagEVPeriod`", "任意", "文字列（ ``#`` 区切り）", "イベントのタグを設定する", "#主人公3人組 #不死鳥の騎士団"
    ":ref:`flagIdPeriod`", "任意", "文字列", "フラグイベントのIDを設定する", "flag1"

2. 各設定項目
===============================

.. _categoryEP:

カテゴリ
------------------------------------------------
該当イベントの対象範囲を設定します。

全員を対象とするイベントは ``all`` 、特定のカテゴリを対象とするイベントは ``{カテゴリ名}`` 、個人を対象とするイベントは ``{キャラクタ名}`` を指定してください。

.. _titleP:

タイトル
-------------------------------
該当イベントのタイトル（概要）を設定します。なお、セル内での改行はイベントカードに反映されます。

.. _startDate:

開始日時
-------------------------------
該当イベントの開始年、月、日、時、分を設定します。

年月日以下の粒度のデータが必要ない場合は ``yyyy/MM/dd`` 形式、必要な場合は ``yyyy/MM/dd hh:mm`` 形式で指定してください。

.. note::
    Excelが自動で日付の表示形式を変更する（ ``21-Jan`` 等）ことがありますが、修正する必要はありません

.. _endDate:

終了日時
-------------------------------
該当イベントの終了年、月、日、時、分を設定します。

年月日以下の粒度のデータが必要ない場合は ``yyyy/MM/dd`` 形式、必要な場合は ``yyyy/MM/dd hh:mm`` 形式で指定してください。

.. note::
    Excelが自動で日付の表示形式を変更する（ ``21-Jan`` 等）ことがありますが、修正する必要はありません

.. _limitP:

以下を無視
-------------------------------
指定した値より細かい時間設定をイベントカード上で非表示にします。デフォルトでは ``hour`` が指定されます。

``month`` 、 ``day`` 、 ``hour`` 、 ``minute`` 、 ``second`` が使用可能です。日時を ``1900/1/1 00:01`` に設定した場合、各値による開始・終了イベントカード上での表示は以下のようになります。

.. csv-table::
    :header: "設定値", "年表示列", "カード1行目", "カード2行目", "カード3行目"

    "``month``", "1900", "", "", ""
    "``day``", "1900", "1", "", ""
    "``hour``", "1900", "1", "1TH", ""
    "``minute``", "1900", "1", "1TH", "00:00"
    "``second``", "1900", "1", "1TH", "00:01"

.. _display:

経過時間粒度
-------------------------------
期間イベントの開始からの経過時間の表示粒度を指定します。 ``year`` 、 ``month`` 、 ``day`` 、 ``hour`` 、 ``minute`` 、 ``second`` が使用可能で、デフォルトでは ``day`` が指定されます。

.. _startDetail:

開始時詳細
-------------------------------
該当期間イベント開始イベントの詳細情報を設定します。なお、セル内での改行はイベントカードに反映されます。

.. _endDetail:

終了時詳細
-------------------------------
該当期間イベント終了イベントの詳細情報を設定します。なお、セル内での改行はイベントカードに反映されます。

.. _impEVP:

重要イベント
------------------------------------------------
該当のイベントを重要イベントに設定します。

``TRUE`` を設定していないイベントは、重要イベントハイライトモードに切り替えた際に薄めの色で表示されます。

.. _tagEVPeriod:

タグ
-------------------------------
該当期間イベントのタグを設定します。半角の ``#`` をつけた形式で記載してください。

.. _flagIdPeriod:

フラグID
----------------------------------------------------------------
該当フラグのIDを設定します。ここでIDを指定すると、開始日時から終了日時までをフラグ回収可能期間としたフラグイベントとして扱われます。

同一フラグIDをもつ単一イベントをイベントシートに追加すると、当該イベントが開始日時から終了日時までに発生した場合、イベント設定先のキャラクタのフラグが回収されたと見做します。フラグに対してフラグ回収したキャラクターが全員ではない、ないし異なる、ないし回収が行われていない場合、フラグ未回収カードが追加されます。